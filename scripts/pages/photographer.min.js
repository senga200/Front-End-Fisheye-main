const modalLightBox=document.querySelector("#lightBox_Modal"),content=document.querySelector(".lightBoxContent");let indexCourant=0,photos=[];const suivant=document.querySelector(".suivant"),precedent=document.querySelector(".precedent"),gallery=document.querySelector(".photograph-gallery"),children=gallery.children;let photographerPrice;async function getPhotographerData(){try{const params=new URLSearchParams(location.search),id=params.get("id"),response=await fetch("http://127.0.0.1:5501/data/photographers.json"),data=await response.json(),photographer=data.photographers.find(photographer=>photographer.id==id),photos=data.media.filter(photo=>photo.photographerId==id);return photographer.photos=photos,photographerPrice=photographer.price,photographer}catch(error){console.error(error)}}async function recupData(){const photographer=await getPhotographerData();mediaFactory(photographer),photos=photographer.photos,displayMedia(photos);const nom=document.querySelector(".nom");nom.innerHTML=photographer.name}function displayMedia(){let totalCompteur=0;photos.forEach((photo,index)=>{const grid=document.createElement("div");grid.style.cursor="pointer";const infoPhoto=document.createElement("div");infoPhoto.innerHTML=`<h4>${photo.title}</h4>`,infoPhoto.style.display="flex",infoPhoto.style.justifyContent="space-around",infoPhoto.style.alignItems="center",infoPhoto.style.padding="0",totalCompteur+=photo.likes;let alreadyClicked=!1;const blocPriceLikes=document.querySelector(".priceLikes"),totalLikes=document.querySelector(".totalLikes"),price=document.querySelector(".price");totalLikes.innerHTML=totalCompteur+" ❤ "+photographerPrice+" € / jour ";const heart=document.createElement("span");heart.style.cursor="pointer",heart.innerHTML="❤"+photo.likes,heart.addEventListener("click",(function(){alreadyClicked||(photo.likes++,totalCompteur++,totalLikes.innerHTML=totalCompteur+" ❤"+photographerPrice+" € / jour ",heart.innerHTML="❤"+photo.likes,alreadyClicked=!0)})),photo.image?grid.innerHTML=`<img src="assets/images/${photo.image}" alt="${photo.title}" />`:photo.video&&(grid.innerHTML=`<video src="assets/images/${photo.video}" alt="${photo.title}" controls>`),grid.querySelector("img, video").addEventListener("click",()=>{openLightBox(photos,index)}),gallery.appendChild(grid),grid.appendChild(infoPhoto),infoPhoto.appendChild(heart),blocPriceLikes.appendChild(price),blocPriceLikes.appendChild(totalLikes)})}document.addEventListener("DOMContentLoaded",recupData),suivant.addEventListener("click",()=>{indexCourant>=photos.length&&(indexCourant=0),indexCourant++,openLightBox(photos,indexCourant)}),precedent.addEventListener("click",()=>{indexCourant<0&&(indexCourant=photos.length-1),indexCourant--,openLightBox(photos,indexCourant)}),document.addEventListener("keydown",e=>{"ArrowLeft"===e.key?precedent.click():"ArrowRight"===e.key&&suivant.click(),openLightBox(photos,indexCourant)}),modalLightBox.addEventListener("keydown",e=>{"Escape"===e.key&&closeLightBox()}),modalLightBox.addEventListener("keydown",e=>{"Enter"===e.key&&openLightBox()});const fermer=document.querySelector(".close");function openLightBox(photos,index){const photo=photos[index];let url;photo.image?(url=`assets/images/${photo.image}`,content.innerHTML=`<img src="${url}" alt="${photo.title}"/><h4>${photo.title}</h4>`):photo.video&&(url=`assets/images/${photo.video}`,content.innerHTML=`<video src="${url}" alt="${photo.title}"controls><h4>${photo.title}</h4>`),modalLightBox.style.display="block"}function closeLightBox(){modalLightBox.style.display="none"}function closeLightBox(){const modalLightBox=document.querySelector("#lightBox_Modal");modalLightBox.style.display="none"}const select=document.getElementById("selector");select.addEventListener("change",()=>{const selectedOption=select.value;switch(indexCourant=[0],selectedOption){case"popularite":photos.sort((function(a,b){return a.likes<b.likes?1:a.likes>b.likes?-1:0}));break;case"Date":photos.sort((function(a,b){return a.date<b.date?-1:a.date>b.date?1:0}));break;case"Titre":photos.sort((function(a,b){return a.title<b.title?-1:a.title>b.title?1:0}))}for(;children.length>0;)children[0].remove();displayMedia()});